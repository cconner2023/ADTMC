const e="adtmc-cache-v2.6",t="/ADTMC/",c="v3",n=[{"revision":"322bd41ccaf37ebf4993400809f6ccb8","url":"registerSW.js"},{"revision":"41bc284f13617ce9c31359940a5622fe","url":"manifest.json"},{"revision":"4176cf9dbb68f23e8ecce2990f1217e5","url":"index.html"},{"revision":"b2194a7c346b97746b127f2d0d9b13aa","url":"icon-512.png"},{"revision":"b2194a7c346b97746b127f2d0d9b13aa","url":"icon-512-maskable.png"},{"revision":"bbc951fe177cbc880153d776bad72641","url":"icon-192.png"},{"revision":"390685e39dd217b4fb4ec6557f694306","url":"icon-144.png"},{"revision":null,"url":"assets/main.DQSUsefT.js"},{"revision":null,"url":"assets/main.CFtlm7lu.css"},{"revision":null,"url":"assets/icon-144.B1hyUDeF.png"},{"revision":"bbc951fe177cbc880153d776bad72641","url":"icon-192.png"},{"revision":"b2194a7c346b97746b127f2d0d9b13aa","url":"icon-512-maskable.png"},{"revision":"b2194a7c346b97746b127f2d0d9b13aa","url":"icon-512.png"}],s=[t,t+"index.html",t+"manifest.json"];async function a(t,n){try{const s=await caches.open(e),a=await s.match(t);if(a){const[e,s]=await Promise.all([a.text(),n.clone().text()]);if(e!==s){console.log("[Service Worker] Content updated:",t.url);(await self.clients.matchAll()).forEach(e=>{e.postMessage({type:"CONTENT_UPDATED",url:t.url,version:c,timestamp:(new Date).toISOString()})})}}}catch(s){console.log("[Service Worker] Error checking content update:",s)}}self.addEventListener("install",t=>{console.log("[Service Worker] Installing version:",c),self.skipWaiting(),t.waitUntil(caches.open(e).then(e=>{console.log("[Service Worker] Caching critical assets");const t=[...s];return n&&Array.isArray(n)&&n.forEach(e=>{const c="string"==typeof e?e:e.url;c&&!t.includes(c)&&t.push(c)}),e.addAll(t.map(e=>new Request(e,{cache:"reload"})))}).then(()=>{console.log("[Service Worker] Install completed")}))}),self.addEventListener("activate",t=>{console.log("[Service Worker] Activating"),t.waitUntil(caches.keys().then(t=>Promise.all(t.map(t=>{if(t!==e&&t.startsWith("adtmc-cache-"))return console.log("[Service Worker] Deleting old cache:",t),caches.delete(t)}))).then(()=>self.clients.claim()).then(()=>{console.log("[Service Worker] Activation completed"),self.clients.matchAll().then(t=>{t.forEach(t=>{t.postMessage({type:"SW_READY",version:c,cacheName:e})})})}))}),self.addEventListener("fetch",c=>{if("GET"!==c.request.method)return;const n=new URL(c.request.url);n.origin===self.location.origin&&"chrome-extension:"!==n.protocol&&("document"===c.request.destination||n.pathname.endsWith(".html")||n.pathname===t||n.pathname===t.slice(0,-1)?c.respondWith(async function(t){try{const c=await fetch(t);if(c.ok){const n=c.clone();caches.open(e).then(e=>{e.put(t,n).then(()=>{a(t,c)})})}return c}catch(c){throw console.log("[Service Worker] Network failed for:",t.url,c),c}}(c.request).catch(()=>caches.match(c.request))):"script"===c.request.destination||"style"===c.request.destination||n.pathname.endsWith(".js")||n.pathname.endsWith(".css")?c.respondWith(async function(t){const c=await caches.open(e),n=await c.match(t),s=fetch(t).then(e=>(e.ok&&(c.put(t,e.clone()),a(t,e)),e)).catch(()=>{});return n||s}(c.request)):c.respondWith(async function(t){const c=await caches.open(e),n=await c.match(t);if(n)return fetch(t).then(e=>{e.ok&&(c.put(t,e.clone()),a(t,e))}).catch(()=>{}),n;return fetch(t)}(c.request)))}),self.addEventListener("message",t=>{"skipWaiting"===t.data&&self.skipWaiting(),"checkForUpdates"===t.data&&self.registration.update(),"CLEAR_CACHE"===t.data.type&&caches.delete(e).then(()=>{console.log("[Service Worker] Cache cleared by user request"),t.ports?.[0]?.postMessage({success:!0})}),"GET_CACHE_INFO"===t.data.type&&caches.open(e).then(n=>{n.keys().then(n=>{t.ports?.[0]?.postMessage({cacheName:e,cacheSize:n.length,version:c})})})}),"periodicSync"in self.registration&&self.addEventListener("periodicsync",t=>{"update-check"===t.tag&&t.waitUntil(async function(){console.log("[Service Worker] Performing periodic update check");try{const c=await caches.open(e),n=await c.keys();for(const e of n)try{const t=await fetch(e);t.ok&&await c.put(e,t.clone())}catch(t){}console.log("[Service Worker] Update check completed")}catch(t){console.log("[Service Worker] Update check failed:",t)}}())}),"backgroundFetch"in self&&self.addEventListener("backgroundfetchsuccess",e=>{console.log("[Service Worker] Background fetch succeeded:",e.registration.id)});
